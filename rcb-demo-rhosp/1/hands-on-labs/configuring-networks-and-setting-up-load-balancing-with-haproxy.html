<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Configuring networks and setting up load balancing with HAProxy :: Basics of RHOSP</title>
    <link rel="prev" href="deploying-virtual-machines-using-nova-and-glance.html">
    <link rel="next" href="../appendix/appendix.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img src="../../../_/img/redhat-logo.png" height="40px" alt="Red Hat"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="../../..">Basics of RHOSP</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/RedHatQuickCourses/course-starter-template/issues" target="_blank">Report Issues</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="rcb-demo-rhosp" data-version="1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Basics of RHOSP</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Home</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../LABENV/index.html">Lab Environment</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../overview-of-openstack-architecture/overview-of-openstack-architecture.html">Overview of OpenStack architecture</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../overview-of-openstack-architecture/openstack-services-and-their-functions.html">OpenStack services and their functions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../overview-of-openstack-architecture/relationship-between-openstack-projects-eg-nova-glance-keystone.html">Relationship between OpenStack projects (e.g., Nova, Glance, Keystone)</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../virtual-machine-deployment/virtual-machine-deployment.html">Virtual machine deployment</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../virtual-machine-deployment/nova-and-glance-interaction-for-vm-creation.html">Nova and Glance interaction for VM creation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../virtual-machine-deployment/flavors-images-and-instance-management.html">Flavors, images, and instance management</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../network-configuration-in-rhosp/network-configuration-in-rhosp.html">Network configuration in RHOSP</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../network-configuration-in-rhosp/neutron-networking-overview.html">Neutron networking overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../network-configuration-in-rhosp/setting-up-networks-subnets-and-routers.html">Setting up networks, subnets, and routers</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="hands-on-labs.html">Hands-on Labs</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="user-management-exercises-create-users-roles-and-projects.html">User management exercises: create users, roles, and projects</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="deploying-virtual-machines-using-nova-and-glance.html">Deploying virtual machines using Nova and Glance</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="configuring-networks-and-setting-up-load-balancing-with-haproxy.html">Configuring networks and setting up load balancing with HAProxy</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendix/appendix.html">Appendix</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Basics of RHOSP</span>
    <span class="version">1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">Basics of RHOSP</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Basics of RHOSP</a></li>
    <li><a href="hands-on-labs.html">Hands-on Labs</a></li>
    <li><a href="configuring-networks-and-setting-up-load-balancing-with-haproxy.html">Configuring networks and setting up load balancing with HAProxy</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Configuring networks and setting up load balancing with HAProxy</h1>
<h1 id="_configuring_networks_and_setting_up_load_balancing_with_haproxy" class="sect0"><a class="anchor" href="#_configuring_networks_and_setting_up_load_balancing_with_haproxy"></a>Configuring networks and setting up load balancing with HAProxy</h1>
<div class="sect1">
<h2 id="_overview"><a class="anchor" href="#_overview"></a>Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this section, we will explore how to configure networks within OpenStack and set up load balancing using HAProxy. This hands-on activity is crucial for understanding how to manage resources efficiently and ensure high availability in a RHOSP (Red Hat OpenStack Platform) environment.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_neutron_networking_overview"><a class="anchor" href="#_neutron_networking_overview"></a>Neutron Networking Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>OpenStack Networking (Neutron) provides a way to create and manage virtual networks connecting the various components of an OpenStack deployment. It offers several network types, such as Flat (untagged), VLAN (tagged), VXLAN (tunneled), and GRE (generic routing encapsulation).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_setting_up_networks_subnets_and_routers"><a class="anchor" href="#_setting_up_networks_subnets_and_routers"></a>Setting up Networks, Subnets, and Routers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To set up a basic network in RHOSP, follow these steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Create a Network:</strong></p>
<div class="literalblock">
<div class="content">
<pre>Use the following OpenStack command to create a new network named 'my-network' using VLAN technology:</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>```
openstack network create --provider-network-type vlan --physical-network 30 my-network
```</pre>
</div>
</div>
</li>
<li>
<p><strong>Create a Subnet:</strong></p>
<div class="literalblock">
<div class="content">
<pre>Create a subnet within the newly created network, specifying its IP range (e.g., 192.168.1.0/24):</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>```
openstack subnet create --network my-network --subnet-range 192.168.1.0/24 my-subnet
```</pre>
</div>
</div>
</li>
<li>
<p><strong>Create a Router:</strong></p>
<div class="literalblock">
<div class="content">
<pre>Next, create a router to connect different networks:</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>```
openstack router create my-router
```</pre>
</div>
</div>
</li>
<li>
<p><strong>Add Interfaces to the Router:</strong></p>
<div class="literalblock">
<div class="content">
<pre>Attach the created subnet's interface to the router:</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>```
openstack router add subnet &lt;router_id&gt; &lt;subnet_id&gt;
```</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_setting_up_load_balancing_with_haproxy"><a class="anchor" href="#_setting_up_load_balancing_with_haproxy"></a>Setting up Load Balancing with HAProxy</h2>
<div class="sectionbody">
<div class="paragraph">
<p>HAProxy (High Availability Proxy) is a popular open-source load balancer used in conjunction with OpenStack for distributing network or application traffic across multiple servers. To set up HAProxy for load balancing:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Install HAProxy:</strong></p>
<div class="literalblock">
<div class="content">
<pre>Install HAProxy on the desired control node using package manager:</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>```
sudo yum install haproxy -y
```</pre>
</div>
</div>
</li>
<li>
<p><strong>Configure HAProxy:</strong></p>
<div class="literalblock">
<div class="content">
<pre>Create a configuration file for HAProxy, e.g., `/etc/haproxy.cfg`, with the following basic load-balancing setup:</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>```
global
  log /dev/log local0
  log /dev/log local1 notice
  stats uri /stats socket /run/haproxy/admin.sock mode 755 level admin</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>defaults
    log global
    mode http
    option httplog
    option dontlognull
    timeout connect 5000
    timeout client 50000
    timeout server 50000</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>frontend http-in
    bind *:80
    default_backend servers</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>backend servers
    server web1 192.168.1.10:80 check
    server web2 192.168.1.11:80 check
```</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>This configuration sets up a simple HTTP load balancer that distributes traffic between two web servers (web1 and web2) at IPs 192.168.1.10 and 192.168.1.11 respectively.</pre>
</div>
</div>
</li>
<li>
<p><strong>Start HAProxy:</strong></p>
<div class="literalblock">
<div class="content">
<pre>Start the HAProxy service:</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>```
sudo systemctl start haproxy
```</pre>
</div>
</div>
</li>
<li>
<p><strong>Enable on Boot:</strong></p>
<div class="literalblock">
<div class="content">
<pre>Ensure that HAProxy starts automatically at boot time:</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>```
sudo systemctl enable haproxy
```</pre>
</div>
</div>
</li>
<li>
<p><strong>Test Configuration:</strong></p>
<div class="literalblock">
<div class="content">
<pre>Test the HAProxy configuration for syntax errors before applying changes to a production environment:</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>```
sudo haproxy -c -f /etc/haproxy.cfg
```</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>By completing these hands-on lab activities, you will gain practical experience in configuring networks within RHOSP and setting up load balancing using HAProxy, enabling you to create high availability and scalable environments.</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="deploying-virtual-machines-using-nova-and-glance.html">Deploying virtual machines using Nova and Glance</a></span>
  <span class="next"><a href="../appendix/appendix.html">Appendix</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
